============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-6.2.5, py-1.10.0, pluggy-0.13.1
django: settings: posthog.settings (from ini)
rootdir: /workspaces/posthog, configfile: pytest.ini
plugins: celery-4.4.7, flaky-3.7.0, env-0.6.2, cov-2.12.1, icdiff-0.5, syrupy-1.4.6, asyncio-0.20.3, Faker-17.5.0, mock-3.5.1, django-4.1.0, split-0.6.0
asyncio: mode=strict
collected 2649 items

hogvm/python/test/test_execute.py ....                                   [  0%]
posthog/api/dashboards/test/test_dashboard_templates.py F..F.FFF.FF..F   [  0%]
posthog/api/test/test_action.py .................                        [  1%]
posthog/api/test/test_activity_log.py ..                                 [  1%]
posthog/api/test/test_annotation.py .........                            [  1%]
posthog/api/test/test_app_metrics.py ....                                [  1%]
posthog/api/test/test_async_migrations.py ........                       [  2%]
posthog/api/test/test_authentication.py ................................ [  3%]
                                                                         [  3%]
posthog/api/test/test_capture.py ....................................... [  4%]
..............FF.....                                                    [  5%]
posthog/api/test/test_cohort.py ..................                       [  6%]
posthog/api/test/test_decide.py ........................................ [  7%]
...............                                                          [  8%]
posthog/api/test/test_early_access_feature.py ..................         [  9%]
posthog/api/test/test_element.py ...............                         [  9%]
posthog/api/test/test_event.py ..............F.........                  [ 10%]
posthog/api/test/test_event_definition.py ........                       [ 10%]
posthog/api/test/test_exports.py ............                            [ 11%]
posthog/api/test/test_feature_flag.py .................................. [ 12%]
..................FFFFF.....                                             [ 13%]
posthog/api/test/test_geoip.py ...                                       [ 13%]
posthog/api/test/test_ingestion_warnings.py .                            [ 13%]
posthog/api/test/test_insight.py .......s.............................FF [ 15%]
..................................s.                                     [ 16%]
posthog/api/test/test_insight_funnels.py .................               [ 17%]
posthog/api/test/test_insight_query.py ..........                        [ 17%]
posthog/api/test/test_instance_settings.py .........                     [ 18%]
posthog/api/test/test_instance_status.py ...F...                         [ 18%]
posthog/api/test/test_kafka_inspector.py ..                              [ 18%]
posthog/api/test/test_organization.py .F.......                          [ 18%]
posthog/api/test/test_organization_domain.py ............F.FFF.....      [ 19%]
posthog/api/test/test_organization_invites.py ..........                 [ 19%]
posthog/api/test/test_organization_members.py ..........                 [ 20%]
posthog/api/test/test_person.py .............................            [ 21%]
posthog/api/test/test_personal_api_keys.py .............                 [ 21%]
posthog/api/test/test_persons_trends.py ....................FF.          [ 22%]
posthog/api/test/test_plugin.py .................F...................... [ 24%]
......                                                                   [ 24%]
posthog/api/test/test_preflight.py ...FFFF.....                          [ 24%]
posthog/api/test/test_prompt.py .....                                    [ 25%]
posthog/api/test/test_property_definition.py ............                [ 25%]
posthog/api/test/test_query.py ................FF                        [ 26%]
posthog/api/test/test_session_recordings.py ..........................   [ 27%]
posthog/api/test/test_sharing.py ................                        [ 27%]
posthog/api/test/test_signup.py ..F...FF........FFFF.........F.......... [ 29%]
..                                                                       [ 29%]
posthog/api/test/test_signup_demo.py ....                                [ 29%]
posthog/api/test/test_site_app.py ..                                     [ 29%]
posthog/api/test/test_survey.py .........                                [ 29%]
posthog/api/test/test_tagged_item.py ......                              [ 30%]
posthog/api/test/test_team.py ........................                   [ 31%]
posthog/api/test/test_uploaded_media.py ......                           [ 31%]
posthog/api/test/test_user.py .......................................... [ 32%]
..                                                                       [ 32%]
posthog/api/test/test_utils.py .......                                   [ 33%]
posthog/api/test/batch_exports/test_backfill.py .....                    [ 33%]
posthog/api/test/batch_exports/test_create.py ..                         [ 33%]
posthog/api/test/batch_exports/test_delete.py ...                        [ 33%]
posthog/api/test/batch_exports/test_get.py ...                           [ 33%]
posthog/api/test/batch_exports/test_list.py ...                          [ 33%]
posthog/api/test/batch_exports/test_pause.py .......                     [ 34%]
posthog/api/test/batch_exports/test_runs.py ...                          [ 34%]
posthog/api/test/batch_exports/test_update.py ..                         [ 34%]
posthog/api/test/dashboards/test_dashboard.py .......................... [ 35%]
.............................                                            [ 36%]
posthog/api/test/dashboards/test_dashboard_duplication.py ..             [ 36%]
posthog/api/test/dashboards/test_dashboard_text_tiles.py .....           [ 36%]
posthog/api/test/notebooks/test_notebook.py ...........                  [ 37%]
posthog/async_migrations/test/test_0007_persons_and_groups_on_events_backfill.py . [ 37%]
..............                                                           [ 37%]
posthog/async_migrations/test/test_0010_move_old_partitions.py .         [ 37%]
posthog/async_migrations/test/test_definition.py ..                      [ 37%]
posthog/async_migrations/test/test_migrations_not_required.py .          [ 37%]
posthog/async_migrations/test/test_runner.py ......                      [ 38%]
posthog/async_migrations/test/test_utils.py .......                      [ 38%]
posthog/caching/test/test_fetch_from_cache.py .....                      [ 38%]
posthog/caching/test/test_insight_cache.py ...................           [ 39%]
posthog/caching/test/test_insight_caching_state.py ..................... [ 39%]
...............                                                          [ 40%]
posthog/caching/test/test_should_refresh_insight.py ..........           [ 40%]
posthog/caching/test/test_tolerant_zlib_compressor.py ......             [ 41%]
posthog/clickhouse/test/test_person_overrides.py ..                      [ 41%]
posthog/demo/test/test_matrix_manager.py ....                            [ 41%]
posthog/hogql/database/test/test_argmax.py ..                            [ 41%]
posthog/hogql/database/test/test_database.py ...                         [ 41%]
posthog/hogql/database/test/test_s3_table.py .....                       [ 41%]
posthog/hogql/functions/test/test_cohort.py ....                         [ 41%]
posthog/hogql/functions/test/test_sparkline.py ..                        [ 41%]
posthog/hogql/test/test_bytecode.py ..                                   [ 42%]
posthog/hogql/test/test_escape_sql.py ....                               [ 42%]
posthog/hogql/test/test_metadata.py .....                                [ 42%]
posthog/hogql/test/test_parse_string.py ......                           [ 42%]
posthog/hogql/test/test_parser.py ...................................... [ 44%]
...........                                                              [ 44%]
posthog/hogql/test/test_placeholders.py ....                             [ 44%]
posthog/hogql/test/test_printer.py ..................................... [ 46%]
................                                                         [ 46%]
posthog/hogql/test/test_property.py .................                    [ 47%]
posthog/hogql/test/test_query.py ..F..............................       [ 48%]
posthog/hogql/test/test_resolver.py ................................     [ 49%]
posthog/hogql/test/test_visitor.py .....                                 [ 49%]
posthog/hogql/transforms/test/test_lazy_tables.py ...........            [ 50%]
posthog/hogql/transforms/test/test_property_types.py ......              [ 50%]
posthog/kafka_client/test/test_client.py ......                          [ 50%]
posthog/management/commands/test/test_backfill_persons_and_groups_on_events.py . [ 50%]
.                                                                        [ 50%]
posthog/management/commands/test/test_fix_person_distinct_ids_after_delete.py . [ 50%]
..                                                                       [ 50%]
posthog/management/commands/test/test_run_async_migrations.py .....      [ 51%]
posthog/management/commands/test/test_sync_persons_to_clickhouse.py .... [ 51%]
.......                                                                  [ 51%]
posthog/management/commands/test/test_sync_replicated_schema.py ...      [ 51%]
posthog/models/async_deletion/test_delete_person.py .                    [ 51%]
posthog/models/cohort/test/test_util.py F...........                     [ 52%]
posthog/models/filters/test/test_filter.py ............................. [ 53%]
...                                                                      [ 53%]
posthog/models/filters/test/test_filter_mixins.py ..                     [ 53%]
posthog/models/filters/test/test_lifecycle_filter.py .                   [ 53%]
posthog/models/filters/test/test_path_filter.py ..                       [ 53%]
posthog/models/filters/test/test_retention_filter.py ..                  [ 53%]
posthog/models/filters/test/test_stickiness_filter.py .                  [ 53%]
posthog/models/test/test_activity_logging.py .                           [ 53%]
posthog/models/test/test_async_deletion_model.py ................        [ 54%]
posthog/models/test/test_dashboard_tile_model.py ....                    [ 54%]
posthog/models/test/test_entity_model.py .......                         [ 54%]
posthog/models/test/test_event_model.py ............                     [ 55%]
posthog/models/test/test_exported_asset_model.py .....                   [ 55%]
posthog/models/test/test_insight_caching_state.py .....                  [ 55%]
posthog/models/test/test_insight_model.py ...........                    [ 55%]
posthog/models/test/test_integration_model.py .                          [ 56%]
posthog/models/test/test_organization_model.py .FFF.                     [ 56%]
posthog/models/test/test_person_model.py ...                             [ 56%]
posthog/models/test/test_subscription_model.py .............             [ 56%]
posthog/models/test/test_tagged_item_model.py .......                    [ 57%]
posthog/models/test/test_user_model.py F.                                [ 57%]
posthog/plugins/test/test_utils.py F...F...                              [ 57%]
posthog/queries/app_metrics/test/test_app_metrics.py ............        [ 57%]
posthog/queries/app_metrics/test/test_historical_exports.py ......       [ 58%]
posthog/queries/funnels/test/test_breakdowns_by_current_url.py ..        [ 58%]
posthog/queries/funnels/test/test_funnel.py ............................ [ 59%]
............................s..................                          [ 61%]
posthog/queries/funnels/test/test_funnel_persons.py .............        [ 61%]
posthog/queries/funnels/test/test_funnel_strict.py ..................... [ 62%]
............                                                             [ 62%]
posthog/queries/funnels/test/test_funnel_strict_persons.py .....         [ 62%]
posthog/queries/funnels/test/test_funnel_time_to_convert.py ......       [ 63%]
posthog/queries/funnels/test/test_funnel_trends.py ..................... [ 63%]
.                                                                        [ 64%]
posthog/queries/funnels/test/test_funnel_trends_persons.py ...           [ 64%]
posthog/queries/funnels/test/test_funnel_unordered.py .................. [ 64%]
..................                                                       [ 65%]
posthog/queries/funnels/test/test_funnel_unordered_persons.py ......     [ 65%]
posthog/queries/funnels/test/test_utils.py ....                          [ 65%]
posthog/queries/session_recordings/test/test_session_recording.py ...... [ 66%]
....                                                                     [ 66%]
posthog/queries/session_recordings/test/test_session_recording_list.py . [ 66%]
............................................                             [ 67%]
posthog/queries/session_recordings/test/test_session_recording_list_from_session_replay.py F [ 67%]
.............s.............                                              [ 69%]
posthog/queries/session_recordings/test/test_session_recording_properties.py . [ 69%]
                                                                         [ 69%]
posthog/queries/session_recordings/test/test_session_replay_summaries.py . [ 69%]
                                                                         [ 69%]
posthog/queries/test/test_base.py ........                               [ 69%]
posthog/queries/test/test_lifecycle.py ...............                   [ 69%]
posthog/queries/test/test_paths.py .......                               [ 70%]
posthog/queries/test/test_query_date_range.py ......                     [ 70%]
posthog/queries/test/test_retention.py .........................         [ 71%]
posthog/queries/test/test_trends.py ............FFFF.................... [ 72%]
..FFF................F.FFF.............................................. [ 75%]
........................................F............................... [ 78%]
....                                                                     [ 78%]
posthog/queries/test/test_util.py .                                      [ 78%]
posthog/queries/trends/test/test_breakdowns.py ...........               [ 78%]
posthog/queries/trends/test/test_breakdowns_by_current_url.py ..         [ 78%]
posthog/queries/trends/test/test_formula.py ......F.................     [ 79%]
posthog/queries/trends/test/test_paging_breakdowns.py ..                 [ 79%]
posthog/queries/trends/test/test_person.py F..                           [ 79%]
posthog/storage/test/test_object_storage.py .......                      [ 80%]
posthog/tasks/exports/test/test_csv_exporter.py ............             [ 80%]
posthog/tasks/exports/test/test_csv_exporter_renders.py ...........      [ 81%]
posthog/tasks/exports/test/test_csv_exporter_url_sanitising.py ......... [ 81%]
.                                                                        [ 81%]
posthog/tasks/exports/test/test_image_exporter.py ...                    [ 81%]
posthog/tasks/test/test_async_migrations.py ..                           [ 81%]
posthog/tasks/test/test_calculate_event_property_usage.py ........       [ 81%]
posthog/tasks/test/test_email.py .........                               [ 82%]
posthog/tasks/test/test_exporter.py .F                                   [ 82%]
posthog/temporal/tests/test_squash_person_overrides_workflow.py F....... [ 82%]
..........F