2023-07-12 10:08:20 URL: http://localhost:8123/ 200 OK
~~~~~~~~~~~~~ dropping and creating databases ~~~~~~~~~~~~~
NOTICE:  database "posthog_e2e_test" does not exist, skipping
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100    37    0     0  100    37      0     30  0:00:01  0:00:01 --:--:--    30100    37    0     0  100    37      0     16  0:00:02  0:00:02 --:--:--    16100    37    0     0  100    37      0     11  0:00:03  0:00:03 --:--:--    11100    37    0     0  100    37      0      8  0:00:04  0:00:04 --:--:--     8100    37    0     0  100    37      0      7  0:00:05  0:00:05 --:--:--     7100    37    0     0  100    37      0      5  0:00:07  0:00:06  0:00:01     0100    37    0     0  100    37      0      5  0:00:07  0:00:07 --:--:--     0100    37    0     0  100    37      0      4  0:00:09  0:00:08  0:00:01     0100    37    0     0  100    37      0      4  0:00:09  0:00:09 --:--:--     0100    37    0     0  100    37      0      3  0:00:12  0:00:10  0:00:02     0100    37    0     0  100    37      0      3  0:00:12  0:00:11  0:00:01     0100    37    0     0  100    37      0      3  0:00:12  0:00:12 --:--:--     0100    37    0     0  100    37      0      2  0:00:18  0:00:13  0:00:05     0100    37    0     0  100    37      0      2  0:00:18  0:00:14  0:00:04     0100    37    0     0  100    37      0      2  0:00:18  0:00:15  0:00:03     0100    37    0     0  100    37      0      2  0:00:18  0:00:16  0:00:02     0100    37    0     0  100    37      0      2  0:00:18  0:00:17  0:00:01     0100    37    0     0  100    37      0      2  0:00:18  0:00:18 --:--:--     0100    37    0     0  100    37      0      1  0:00:37  0:00:19  0:00:18     0100    37    0     0  100    37      0      1  0:00:37  0:00:20  0:00:17     0100    37    0     0  100    37      0      1  0:00:37  0:00:21  0:00:16     0100    37    0     0  100    37      0      1  0:00:37  0:00:22  0:00:15     0100    37    0     0  100    37      0      1  0:00:37  0:00:23  0:00:14     0100    37    0     0  100    37      0      1  0:00:37  0:00:24  0:00:13     0100    37    0     0  100    37      0      1  0:00:37  0:00:25  0:00:12     0100    37    0     0  100    37      0      1  0:00:37  0:00:26  0:00:11     0100    37    0     0  100    37      0      1  0:00:37  0:00:27  0:00:10     0100    37    0     0  100    37      0      1  0:00:37  0:00:28  0:00:09     0100    37    0     0  100    37      0      1  0:00:37  0:00:29  0:00:08     0100    37    0     0  100    37      0      1  0:00:37  0:00:30  0:00:07     0100    37    0     0  100    37      0      1  0:00:37  0:00:31  0:00:06     0100    37    0     0  100    37      0      1  0:00:37  0:00:32  0:00:05     0100    37    0     0  100    37      0      1  0:00:37  0:00:33  0:00:04     0100    37    0     0  100    37      0      1  0:00:37  0:00:34  0:00:03     0100    37    0     0  100    37      0      1  0:00:37  0:00:35  0:00:02     0100    37    0     0  100    37      0      1  0:00:37  0:00:36  0:00:01     0100    37    0     0    0    37      0      0 --:--:--  0:00:37 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:38 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:39 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:40 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:41 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:42 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:43 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:44 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:45 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:46 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:47 --:--:--     0100    37    0     0    0    37      0      0 --:--:--  0:00:47 --:--:--     0
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100    29    0     0  100    29      0    302 --:--:-- --:--:-- --:--:--   298100    29    0     0  100    29      0    302 --:--:-- --:--:-- --:--:--   298
~~~~~~~~~~~~~ migrating databases ~~~~~~~~~~~~~
2023-07-12 10:09.16 [warning  ] ['️WARNING! E2E_TESTING is set to `True`. This is a security vulnerability unless you are running tests.']
System check identified some issues:

WARNINGS:
?: (axes.W001) You are using the django-axes cache handler for login attempt tracking. Your cache configuration is however invalid and will not work correctly with django-axes. This can leave security holes in your login systems as attempts are not tracked correctly. Reconfigure settings.AXES_CACHE and settings.CACHES per django-axes configuration documentation.
Operations to perform:
  Apply all migrations: admin, auth, axes, contenttypes, otp_static, otp_totp, posthog, sessions, social_django, two_factor
Running migrations:
  Applying contenttypes.0001_initial... OK
  Applying contenttypes.0002_remove_content_type_name... OK
  Applying auth.0001_initial... OK
  Applying auth.0002_alter_permission_name_max_length... OK
  Applying auth.0003_alter_user_email_max_length... OK
  Applying auth.0004_alter_user_username_opts... OK
  Applying auth.0005_alter_user_last_login_null... OK
  Applying auth.0006_require_contenttypes_0002... OK
  Applying auth.0007_alter_validators_add_error_messages... OK
  Applying auth.0008_alter_user_username_max_length... OK
  Applying auth.0009_alter_user_last_name_max_length... OK
  Applying auth.0010_alter_group_name_max_length... OK
  Applying auth.0011_update_proxy_permissions... OK
  Applying posthog.0001_initial_squashed_0284_improved_caching_state_idx... OK
  Applying admin.0001_initial... OK
  Applying admin.0002_logentry_remove_auto_add... OK
  Applying admin.0003_logentry_add_action_flag_choices... OK
  Applying auth.0012_alter_user_first_name_max_length... OK
  Applying axes.0001_initial... OK
  Applying axes.0002_auto_20151217_2044... OK
  Applying axes.0003_auto_20160322_0929... OK
  Applying axes.0004_auto_20181024_1538... OK
  Applying axes.0005_remove_accessattempt_trusted... OK
  Applying axes.0006_remove_accesslog_trusted... OK
  Applying otp_static.0001_initial... OK
  Applying otp_static.0002_throttling... OK
  Applying otp_totp.0001_initial... OK
  Applying otp_totp.0002_auto_20190420_0723... OK
  Applying posthog.0285_capture_performance_opt_in... OK
  Applying posthog.0286_index_insightcachingstate_lookup... OK
  Applying posthog.0287_add_session_recording_model... OK
  Applying posthog.0288_add_session_recording_persistence... OK
  Applying posthog.0289_add_tags_to_feature_flags... OK
  Applying posthog.0290_add_dashboard_templates... OK
  Applying posthog.0291_create_person_override_model... OK
  Applying posthog.0292_property_definitions_persons_and_groups_support... OK
  Applying posthog.0293_property_definitions_drop_old_constraint... OK
  Applying posthog.0294_plugin_blank_fields... OK
  Applying posthog.0295_plugin_allow_blank_config_schema... OK
  Applying posthog.0296_team_allow_blank_fields... OK
  Applying posthog.0297_property_definitions_index_query... OK
  Applying posthog.0298_add_insight_queries... OK
  Applying posthog.0299_set_templates_global... OK
  Applying posthog.0300_add_constraints_to_person_override... OK
  Applying posthog.0301_organization_enforce_2fa... OK
  Applying posthog.0302_add_user_pending_email_and_is_verified... OK
  Applying posthog.0303_team_session_recording_version... OK
  Applying posthog.0304_store_dashboard_template_in_db... OK
  Applying posthog.0305_rework_person_overrides... OK
  Applying posthog.0306_featureflag_dashboard... OK
  Applying posthog.0307_pluginconfig_admin... OK
  Applying posthog.0308_add_indirect_person_override_constraints... OK
  Applying posthog.0309_team_autocapture_opt_out... OK
  Applying posthog.0310_add_starter_dashboard_template... OK
  Applying posthog.0311_dashboard_template_scope... OK
  Applying posthog.0312_organization_available_product_features... OK
  Applying posthog.0313_early_access_feature... OK
  Applying posthog.0314_sharingconfiguration_recording... OK
  Applying posthog.0315_notebook... OK
  Applying posthog.0316_action_href_text_matching... OK
  Applying posthog.0317_batch_export_models... OK
  Applying posthog.0318_alter_earlyaccessfeature_stage... OK
  Applying posthog.0319_user_requested_password_reset_at... OK
  Applying posthog.0320_survey... OK
  Applying posthog.0321_add_exception_autocapture_optin... OK
  Applying posthog.0322_auto_20230531_1904... OK
  Applying posthog.0323_alter_batchexportdestination_type... OK
  Applying posthog.0324_user_has_seen_product_intro_for... OK
  Applying posthog.0325_alter_dashboardtemplate_scope... OK
  Applying posthog.0326_team_extra_settings... OK
  Applying posthog.0327_alter_earlyaccessfeature_stage... OK
  Applying posthog.0328_add_starter_feature_flag_template... OK
  Applying posthog.0329_datawarehousecredential_datawarehousetable... OK
  Applying posthog.0330_add_autocapture_exceptions_events_to_ignore... OK
  Applying posthog.0331_add_missing_property_definition_index... OK
  Applying posthog.0332_featureflag_has_enriched_analytics... OK
  Applying posthog.0333_add_timestamp_fields_to_batch_exports... OK
  Applying posthog.0334_add_asset_ttl... OK
  Applying posthog.0335_alter_asyncdeletion_deletion_type... OK
  Applying sessions.0001_initial... OK
  Applying social_django.0001_initial... OK
  Applying social_django.0002_add_related_name... OK
  Applying social_django.0003_alter_email_max_length... OK
  Applying social_django.0004_auto_20160423_0400... OK
  Applying social_django.0005_auto_20160727_2333... OK
  Applying social_django.0006_partial... OK
  Applying social_django.0007_code_timestamp... OK
  Applying social_django.0008_partial_timestamp... OK
  Applying social_django.0009_auto_20191118_0520... OK
  Applying social_django.0010_uid_db_index... OK
  Applying two_factor.0001_initial... OK
  Applying two_factor.0002_auto_20150110_0810... OK
  Applying two_factor.0003_auto_20150817_1733... OK
  Applying two_factor.0004_auto_20160205_1827... OK
  Applying two_factor.0005_auto_20160224_0450... OK
  Applying two_factor.0006_phonedevice_key_default... OK
  Applying two_factor.0007_auto_20201201_1019... OK
2023-07-12 10:09.49 [warning  ] ['️WARNING! E2E_TESTING is set to `True`. This is a security vulnerability unless you are running tests.']
System check identified some issues:

WARNINGS:
?: (axes.W001) You are using the django-axes cache handler for login attempt tracking. Your cache configuration is however invalid and will not work correctly with django-axes. This can leave security holes in your login systems as attempts are not tracked correctly. Reconfigure settings.AXES_CACHE and settings.CACHES per django-axes configuration documentation.
Traceback (most recent call last):
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 362, in _get_applied_migrations_and_create_tables
    return self._get_applied_migrations(migrations_package_name, replicated)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 379, in _get_applied_migrations
    return set(obj.module_name for obj in self.select(query))
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 379, in <genexpr>
    return set(obj.module_name for obj in self.select(query))
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 276, in select
    r = self._send(query, settings, True)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 389, in _send
    raise ServerError(r.text)
infi.clickhouse_orm.database.ServerError: Code: 60. DB::Exception: Table posthog_test.infi_clickhouse_orm_migrations_distributed doesn't exist. (UNKNOWN_TABLE) (version 23.6.1.1524 (official build))
 (0)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspaces/posthog/manage.py", line 21, in <module>
    main()
  File "/workspaces/posthog/manage.py", line 17, in main
    execute_from_command_line(sys.argv)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/django/core/management/__init__.py", line 419, in execute_from_command_line
    utility.execute()
  File "/workspaces/posthog/env/lib/python3.10/site-packages/django/core/management/__init__.py", line 413, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/django/core/management/base.py", line 354, in run_from_argv
    self.execute(*args, **cmd_options)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/django/core/management/base.py", line 398, in execute
    output = self.handle(*args, **options)
  File "/workspaces/posthog/posthog/management/commands/migrate_clickhouse.py", line 36, in handle
    self.migrate(CLICKHOUSE_HTTP_URL, options)
  File "/workspaces/posthog/posthog/management/commands/migrate_clickhouse.py", line 74, in migrate
    database.migrate(MIGRATIONS_PACKAGE_NAME, options["upto"], replicated=True)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 346, in migrate
    applied_migrations = self._get_applied_migrations_and_create_tables(migrations_package_name, replicated=replicated)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 371, in _get_applied_migrations_and_create_tables
    return self._get_applied_migrations_and_create_tables(migrations_package_name, replicated, allow_missing_tables=False)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 359, in _get_applied_migrations_and_create_tables
    return self._get_applied_migrations(migrations_package_name, replicated)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 379, in _get_applied_migrations
    return set(obj.module_name for obj in self.select(query))
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 379, in <genexpr>
    return set(obj.module_name for obj in self.select(query))
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 276, in select
    r = self._send(query, settings, True)
  File "/workspaces/posthog/env/lib/python3.10/site-packages/infi/clickhouse_orm/database.py", line 389, in _send
    raise ServerError(r.text)
infi.clickhouse_orm.database.ServerError: Code: 60. DB::Exception: Table posthog_test.infi_clickhouse_orm_migrations doesn't exist. (UNKNOWN_TABLE) (version 23.6.1.1524 (official build))
 (0)
